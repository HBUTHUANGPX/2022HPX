# 工作记录
- 使用solidworks重新搭建了一个简易麦轮底盘，因为之前的麦轮底盘四个轮子全用的是右旋轮，为了在webots中进行仿真工作，所以重新修改了一下模型，重新导出URDF
- webots的仿真：

    1. 为了可以联合ROS开展仿真，经过尝试发现，只能使用2020版，后续高本版编程语言不再支持matlab和ROS
    2. 使用python插件urdf2webots，需要安装老版本的插件
        ```c
        pip install urdf2webots==1.0.1
        ```
        使用方法：

        ```c
        python -m urdf2webots.importer --input=xxxx.urdf
        ```
        即可在执行当前命令行的目录下生成.protos文件，随后即可将protos文件放置与webots项目文件夹下的protos文件夹中。
        
        一般新生成的protos文件需要添加点东西，一个是碰撞属性一个是颜色属性。
        
        例子：
        ```c
        #VRML_SIM R2019a utf8
        # license: Apache License 2.0
        # license url: http://www.apache.org/licenses/LICENSE-2.0
        # This is a proto file for Webots for the Zz
        # Extracted from: /home/lc/2022HPX/learn_ws/src/zz/urdf/zz.urdf

        PROTO Zz [
        field  SFVec3f     translation  0 0 0
        field  SFRotation  rotation     0 1 0 0
        field  SFString    controller   "void"
        field  SFString    name         "MAP"
        field  SFColor     color        1.0 1.0 1.0
        ]
        {
        Robot {
            translation IS translation
            rotation IS rotation
            controller IS controller
            children [
            Shape {
                appearance DEF MAP PBRAppearance { # MAP需要添加，这个例子中只有一个零件存在，所以appearance用不到，其他零件多的时候，可以使用通过DEF定义好的appearance
                baseColor IS color
                transparency 0.0
                roughness 1.0
                metalness 0
                emissiveColor 0.0 0.0 0.0
                }
                geometry DEF map_link IndexedFaceSet {
                coord Coordinate {
                    point [
                        ...
                    ]
                }
                coordIndex [
                    ...
                ]
                creaseAngle 1
                }
            }
            ]
            name "map_link"
            boundingObject USE map_link # 每个link都要添加碰撞属性，和urdf中的collision比较像，但他自己不会自动生成
            physics Physics {
            density -1
            mass 100
            centerOfMass [14.000000 1.0 7.500000 ]
            }
        }
        }
        ```
- 尝试了在12代i5+3060上进行yolo5与tensorrt联合部署（以前已经在10代i7+2060上部署过），因为不明的环境问题导致无法正常导出engine

        ** 这里强调一下：安装CUDA时一定要用runfile，不要用deb，尽管deb很方便，因为如果CUDA用的是deb安装，那么tensorrt也要用deb安装，尽管tensorrt对于CUDA是向下兼容的，但是他会提示你的CUDA不满足最新的版本 **

        后面可能需要用到deepstream，暂时先思考一下其中的意义吧，gstreamer的使用是否能够提升我们的性能。
- 在gazebo中进行仿真的时候总是会遇见一个问题，车子从一个平面上下坡，总会漂浮。后面解决一下这个问题（以解决）。
    
        个人感觉应该是质量属性和惯性属性的问题。但实际上通过修改质量属性和惯性属性（惯性矩，惯性积），并不能改善问题。但通过实践发现，随意放置一个内置的方块，将这个方块上移后，方块是可以正常下落的，但是车子总是非常慢下落，场地就压根不下落。暂且我认为是自定义的物体的质量形成的重力并不能抵消惯性。目前来说是通过更改world文件夹中的重力加速度属性，将z轴方向重力加速度从-9.8改到200～400。很明显的，这样的改动是不符合质点化的物理模型的，至于实际原因是什么，以后有机会再探究。
    
- 学习使用git
- 将思岚的雷达部署测试
        
        这里我发现，R3、R4高低的坡，只有400mm，单线激光雷达上下放置的方案可行性不大
        2D修图的可行性大一点。
    
- 通过USB转232获得ops的数据，目前数据解析有些问题。
- 通过串口读取imu数据。后面需要实现惯性里程计的功能。
- 解决串口的工程问题，实现多串口固定读取

        cd /etc/udev/rules.d
        sudo touch USB.rules
        sudo gedit USB.rules
    随后在新建的USB.rules文件中添加

        KERNEL=="ttyUSB*", ATTRS{idVendor}=="1a86", ATTRS{idProduct}=="7523", MODE:="0777", GROUP:="dialout",  SYMLINK+="USBX"
    其中ATTRS{idVendor}、ATTRS{idProduct}通过运行下面的命令进行查看
        
        udevadm info -a /dev/ttyUSB0

    SYMLINK自定义。最后保存.rules文件，重启电脑。
- 重写PS4的控制,使用ros的joy库，将控制消息发送到cmd_vel话题，实现低延时控制。